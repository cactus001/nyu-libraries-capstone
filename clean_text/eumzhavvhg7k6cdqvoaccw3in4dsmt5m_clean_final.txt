--- Page 0 ---
TDA Progress Report 42-119 November 15, 1994 An Algorithm for Extraction of Periodic Signals From Sparse, Irregularly Sampled Data J. Z. Wilcox Tracking Systems and Applications Section Temporal gaps in discrete sampling sequences produce spurious Fourier compo- nents at the intermodulation frequencies of an oscillatory signal and the temporalgaps, thus signiﬂcantly complicating spectral analysis of such sparsely sampled data.A new fast Fourier transform (FFT)-based algorithm has been developed, suitablefor spectral analysis of sparsely sampled data with a relatively small number ofoscillatory components buried in background noise. The algorithm’s principal ideahas its origin in the so-called \clean" algorithm used to sharpen images of scenescorrupted by atmospheric and sensor aperture eﬁects. It identiﬂes as the signal’s\true" frequency that oscillatory component which, when passed through the samesampling sequence as the original data, produces a Fourier image that is the bestmatch to the original Fourier map. Unlike the clean algorithm, it performs thesearch in the Fourier space. The algorithm has generally met with success on trialswith simulated data with a low signal-to-noise ratio, including those of a type simi-lar to hourly residuals for Earth orientation parameters extracted from VLBI data.For eight oscillatory components in the diurnal and semidiurnal bands, all compo-nents with an amplitude-noise ratio greater than 0.2 were successfully extracted forall sequences and duty cycles (greater than 0.1) tested; the amplitude-noise ratiosof the extracted signals were as low as 0.05 for high duty cycles and long sam-pling sequences. When, in addition to these high frequencies, strong low-frequencycomponents are present in the data, the low-frequency components are generallyeliminated ﬂrst, by employing a version of the algorithm that searches for noninte-ger multiples of the discrete FFT minimum frequency. I. Introduction In observational sciences like astronomy, it frequently happens that data are available at an unevenly spaced set of sampling times. The analyst may wish to extract from these data certain periodic compo-nents for which the frequencies are not precisely known. In fact, signal extraction from sparse or unevenlysampled data may prove crucial to the successful exploitation of large data sets assembled at considerableexpense over many years. If the data acquisition process is characterized by a regular or nearly periodicsuccession of gaps during which no data are taken, sidelobes will occur at frequencies corresponding to theintermodulation products of the various signal and gap frequencies, giving rise to spurious signals in theFourier map. The situation is aggravated by the inevitable presence of noise. In recent years, a numberof authors have developed methods based on Lomb’s normalized periodogram to deal with problems ofthis kind. A set of references and an implementation of Lomb’s method are provided in [1]. A recent 12

--- Page 1 ---
□□ article studied the eﬁect of temporal windows on observed solar oscillation parameters [2]. However, there appears to be no currently available method to search for periodic signals with a low signal-to-noiseratio and unknown frequencies spanning a potentially broad spectral range; nor does there exist a clearunderstanding of the mathematical limits on the kinds of information that might be extracted from suchdata. This article describes a new mathematical procedure for extraction of periodic signals from incomplete data sets. The procedure addresses a situation of particular interest in which only a relatively smallnumber of periodic components are present within a noisy background. Although it may not be possibleeven in principle to extract a large array of broadband signals from sparsely sampled data, the fact thatonly a small number of components are present makes it possible to extract the components in a mannerthat eﬁectively eliminates ambiguity. The main idea of the new procedure comes from the so-called\clean" algorithm [3], which has been extensively used within the astronomical community to sharpenimages of scenes corrupted by atmospheric and sensor aperture eﬁects. Clean algorithms have been mostsuccessful in cleaning up maps of images created by a small number of intense sources. The location ofthe most intense point source is identiﬂed with the highest peak in the scene’s \dirty" map. By modelingthe eﬁects of the atmosphere and sensor aperture (or other intermediate ﬂlters) on the image of a singlelocalized source, the resulting point spread function is subtracted oﬁ, and a point reconstruction addedto a clean map. The process is repeated for successively smaller peaks. Analogous to the clean algorithm, the new algorithm identiﬂes the strongest oscillatory component and produces a Fourier image of this signal as it would be registered if it were sampled in the same manneras the actual data. Unlike in the clean algorithm, a search for the component is performed in Fourierspace. That frequency is identiﬂed as the frequency of the strongest oscillatory component whose Fourierimage is the best match to the Fourier map of the actual data. The image is subtracted from the originalFourier map. The diﬁerence between the old map and the subtracted image is a new residual map, andthe amplitude and frequency of the generating signal are recorded as contributors to the clean map. The algorithm has generally met with success in trials with simulated data, including those of a type similar to hourly residuals for Earth orientation parameters extracted from VLBI data. Some eight signalcomponents in the diurnal and semidiurnal bands with amplitudes varying by an order of magnitude wereadded to a background of Gaussian noise on the same order of magnitude as the oscillatory signal. Fora 2-year-long sampling sequence and 20-percent duty cycle (the duty cycle is deﬂned as the ratio of thelength of time during which the data was taken to the sequence’s total length), all components with anamplitude{noise ratio greater than about 0.2 were successfully extracted; for a 100-percent duty cycle,the extracted amplitude{noise ratio was as low as 0.05. To minimize central processing unit (CPU) time(important for long data sequences), the algorithm uses fast Fourier transforms (FFTs) on uniformlyspaced time markers. The data arrays have zeroes added into the temporal gaps and into the appendedregion (which is added to make the array size equal to a power of two). The CPU time scales as aconstant£N£logN, where the constant depends on the e–ciency of the search for the signal oscillatory frequencies. For N=2 18time markers and 8 cleaning steps, the required CPU time on a VAX-class machine was on the order of several minutes. The frequency resolution is 1 =T, whereTis the sampling sequence length. For cases when a more precise frequency determination is required, or when in additionto the high (i.e., diurnal and semidiurnal) frequencies, the data contains low-frequency components, anoninteger version of the algorithm has been developed. The noninteger version constructs the Fourierimage as a function of frequencies that are not integer multiples of the discrete FFT minimum frequency.An additional search, performed by using a functional minimum-ﬂnding algorithm, extends the search tononinteger frequency values. Compared to the integer algorithm, the noninteger algorithm determinesthe signal frequencies with greatly improved accuracy. It also consumes more CPU time, depending onthe desired accuracy and on the spectral content of the original data. Section II describes the algorithm; Section III describes results of simulation experiments; and the Appendix describes the algorithm extension to frequencies that are not equal to discrete FFT frequencies. 13

--- Page 2 ---
□□ □□□□ II. The Algorithm The data are sampled in a sequence that consists of discrete observation sessions (or windows, on the order of one day) between which there are large gaps (on the order of several days). Within eachsession, data are sampled at uniformly spaced discrete time intervals that are integers of some minimum–t(in our case, 1 hr). The set of hour markers at which the data are taken deﬂnes the sampling function S(t n), which assumes values of 1 or 0 depending upon whether or not a data value was acquired at that particular time. The data deﬂne the array D(tn), in which the entries where no data have been taken have been set to zero. The hour markers are tn=n–t,n=0;1;¢¢¢;N¡1, whereNis the total number of markers in the sampling sequence of duration T=N– t. Note that, to use the FFT, it is most convenient forNto be chosen equal to a power of 2. Sampling at discrete intervals creates a situation whereby frequencies beyond the maximum resolved frequency (Nyquist, equal in our case to 1 =2–t) are aliased (or \folded back") into the lowest frequency region. In addition, the presence of periodic or nearly periodic gaps in the data sequence leads to theappearance of sidelobes and spurious spectral peaks at the signal and gap intermodulation frequencies.The sidelobes are also aliased into the lowest spectral region. To remove the sidelobe eﬁect, the algorithmproduces a Fourier map of the actual data and identiﬂes the strongest oscillatory component. It calculatesa Fourier image of this signal ﬂltered through the same sequence, S(t n), as the actual data, and subtracts it from the original Fourier map to produce a residual map. The most obvious candidate for the strongestcomponent is a frequency with the biggest peak in the original Fourier map. Occasionally, however,the biggest peak occurs at one of the intermodulation frequencies. Therefore, the \true" modulationfrequency is found to be that frequency which when passed through S(t n) is the best match (including the sidelobe structure) for the original Fourier map. LetMldesignate the least squares function: Ml·NX kjDS(k)¡X §a§lfS §l(k)j2 (1) where the sum over kis a sum over all (discrete) frequencies, !k·2…k=(N–t). TheDS(k)i s a discrete Fourier transform of D(tn), and the second term on the right-hand side of Eq. (1) is a Fourier representation of a candidate oscillatory signal of frequency !ltaken over the sampling function S(tn). That is,fS l(k) is a Fourier transform of fl(tn)S(tn), where the periodic function fl(tn)=e x p¡ ¡2…inl N¢ . Note that if there were no gaps in the data (i.e., if S(tn) consisted of an uninterrupted series of data points), then fS l(k) would consist of a single Kronecker delta, –l;k. However, because of the window-gap structure of S(tn), thefS l(k)’s will have sideband components, similar to sideband components of DS(k). Theal’s specify amplitudes of the Fourier components fS l(k). It is important that the Fourier repre- sentation of a candidate oscillatory signal sums over both the positive and negative frequency indexes toaccount for signal phase. To see this, assume that the contribution of the lth oscillatory component to data is A lcosµ 2…nl N+`l¶ (2) where`lis phase. The contribution to the Fourier map is Al 2¡ ei`lfS ¡l(k)+e¡i`lfS l(k)¢ (3) 14

--- Page 3 ---
□□ □□□□ Because Eq. (3) consists of both a positive and its complex conjugate negative frequency components, so must the Fourier image,P §a§lfS §l(k), in Eq. (1). The indexlthat minimizes Mlas a function of lis identiﬂed as the signal’s true frequency. To perform the minimization, DS(k)’s andfS l(k)’s are computed (for all k’s and candidate l’s). The coe–cients a§l are computed from the following complex conjugate relationships for spectral strengths at §llocations in the Fourier map: DS(l)=a¡lfS ¡l(l)+alfS l(l) (4a) DS(¡l)=a¡lfS ¡l(¡l)+alfS l(¡l) (4b) By combining Eqs. (4a) and (4b), the a§l’s are computed for the candidate l. The computed a§l’s are substituted into Eq. (1), whose minimization yields the optimal index lfor the frequency of the strongest oscillatory component. Note that the use of the positive and negative lallows for reconstruction of the signal phase. By comparing Eqs. (3) and (4), the signal phase `lis given by the following expression: tan`l=Ima¡l Rea¡l(5) Hence, the use of the above-described procedure allows one to determine signal phase. The above relationships, Eqs. (4) and (5), were derived by relating the spectral strengths at §llo- cations. It is possible to formally derive Eq. (4) by minimization of Eq. (1) as a function of al.T h e minimization is performed in the Appendix, together with the extension of the algorithm to noninteger l values. Note also that the use of the a§l’s computed from Eq. (4) permits complete subtraction of the spectral strengths at the §llocations; if the data consist of a single frequency, then one subtraction yields a residual at the level of the machine round-oﬁ error or background noise, whichever is bigger. For data modulated with several frequencies, multiple applications of the algorithm are necessary. Equations (1){(5) will apply, except that on the ( i+ 1)th iteration, DS(k) is replaced by a residual array (yi(k)) that has resulted from the ith iteration, yi(k)·yi¡1(k)¡P §a§lifS §li(k), whereliis the optimal index that minimizes Mlat theith iteration, yi¡1(k) is the residual array that has resulted from the (i¡1)th iteration, and yo(k)·DS(k) is the Fourier transform of the original data. With multiple iterations, it may sometimes be desirable to subtract the spectral peaks in fractions. That is (as is acommon practice in the application of the clean algorithm), one subtracts at each iteration only a fractionof the image that has been constructed by using the peak’s full strength. However, the phase relationshipbetween the subtracted a §l’s should be the same as that computed from Eq. (4). Sidelobes associated with one frequency can contribute signal at another frequency. Subtracting the peaks in fractions permits oneto correct for sidelobe contributions associated with other signal frequencies. In any case, the algorithmﬂrst removes (or partially removes) the most intense component (including sidebands due to the window-gap structure), forms the residual array, and treats the residual as a new set of data. The process isiterated to yield a desired number of oscillatory components. III. Results and Discussion Two versions of the above-described general procedure have been implemented and tested on simulated data. In the ﬂrst version, the oscillatory signal that minimizes Eq. (1) consists of two integers, §l,a s in Eq. (3). This version works very well when all modulation frequencies are equal (or nearly equal) todiscrete multiples of 1 =T.I fTis the total length of the sampling sequence, then the spacing for the 15

--- Page 4 ---
□□ □□ resolved frequencies is 1 =T, corresponding to the resolution parameter of ¿2=Tfor an oscillatory signal with period ¿. Thus, this version provides a su–cient resolution for relatively high frequencies, say, ¿<0:01T(in which case, the resolution is better than 1 percent). Because the strongest components are extracted ﬂrst, the accuracy with which these components are extracted impacts the extraction success ofless intense components. The integer version works best when all (relatively rapid) modulation amplitudesare about the same order of magnitude. The second version of the algorithm searches for frequencies thatare not integer multiples of 1 =T(or, equivalently, the frequency indices are not integer multiples of 1 =N). This version allows one, at the expense of increased CPU time, to determine the oscillatory frequencieswith greatly improved accuracy. This version must be used for analysis of data with strong low-frequencycomponents. A. Integer Frequency Index The integer version was tested with success on many diﬁerent types of simulated monochromatic as well as multifrequency signals; the modulations were imbedded in Gaussian noise. The success of frequencyextraction depends on the number of modulation frequencies, the length and structure of the samplingsequence (including length, number, and regularity of individual observational sessions), and noise level. For a monochromatic signal (data sampled hourly), the modulation frequencies ranged from those corresponding to periods of 4 hr to those corresponding to the length Tof the data sequence. Table 1 summarizes the results of the simulations for S(t n) consisting of 20 and 200 1-day-long, periodically repeating sessions separated by several day-long gaps. The residual has been reduced to a backgroundlevel by using a single subtraction step for signal-to-noise amplitude ratios as low as 0.17 and 0.04,respectively, when the duty cycle was 1; the minimum values of the successfully extracted ratios were 0.3and 0.1, and 0.5 and 0.125, for the duty cycles of 0.2 and 0.1, respectively. Here, the duty cycle has beendeﬂned as the ratio of the number of days on which data were recorded to the total number of days inthe observation period (e.g., for a 1-day-long observation session registered on every 5th day, the dutycycle is 1/5). Results of simulations for nonperiodic sampling sequences were similar, except that theextraction tended to be successful even at somewhat higher noise levels. This is not unexpected, sinceconstructive interference (leading to strong sidelobes) is less. Results of simulation experiments for a signal consisting of several modulation frequencies are sum- marized in Tables 2 and 3 and Fig. 1. Eight oscillatory components (four in the semidiurnal band andfour in the diurnal band) with amplitudes varying by an order of magnitude between the strongest andweakest component were added to a background of Gaussian noise. Typical S(t n)’s consisted of 70, 140, and 740 1-day-long observation sessions (data sampled hourly) separated by 4-day- (duty cycle 0.2) and9-day-long (duty cycle 0.1) gaps. The noise amplitude was as high as 100 (the amplitudes of the oscilla-tory components ranged from 3 to 23). The amplitudes and relative phase of the simulated signals aresummarized in Table 2. To demonstrate the resolution for the extracted signals, the table also summa-rizes the results of the extraction process for the 140{data day, 0.2{duty cycle sampling sequence, withthe noise level equal to the amplitude of the strongest component. All eight components were extractedwithin their resolution accuracy (for T=2 16hr, the resolution ¿2=T’0.002 and 0.008 for semidiurnal and diurnal bands, respectively) in eight iteration steps. Figure 1(a) shows the original data, and Figs.1(b), (c), and (d) show, respectively, the original, residual, and clean Fourier maps. Results of simulations for the same oscillatory components but diﬁerent observation parameters are summarized in Table 3. To investigate the eﬁect of excess iterations, the number of cleaning steps usedwas 10. In Table 3, the symbol sdesignates an oscillatory component extracted within its expected resolution, cdesignates an extraction of a previously extracted component, idesignates extraction at one of the intermodulation frequencies, and ndesignates noise (any frequency higher than 1/6 h ¡1was considered a noise). A component may be extracted twice (or several times) because of our use of the fullspectral strength D S(§l) [Eq. (4)] for the subtraction of the Fourier image. The strength DS(§l) consists of contributions from the lth oscillatory component as well as from sidelobes produced by other frequencies 16

--- Page 5 ---
□□ Table 1. Extraction results for simulated mono- chromatic data.a Minimum extracted signal{ noise amplitude ratio Duty cycleNdata days 20 200 1‚0.17‚0.04 2‚0.3‚0.1 1‚0.5‚0.125 aThe listed numbers are the minimum val- ues for the signal{noise amplitude ratio forwhich the extraction was successful. (Thesignal periodicity was ¿=1 1:9672 hr, data sampled hourly.) Table 2. Extraction results for simulated data with four oscillatory components in the diurnal and four in the semidiurnal band.a Periodicity, hr Relative amplitude Phase, deg Simulated data 9672 17.0 126 0000 8.6 9212.4206 3.7 8612.6583 3.2 103 9345 23.0 200 0659 7.0 24025.8193 19.0 6926.8684 5.3 230 Extracted signals 9679 16.4 13912.0007 9.2 10412.4215 4.1 10312.6591 4.2 106 9357 22.8 205 0676 6.0 24325.8219 20.0 8026.8700 6.2 243 aThe background noise relative amplitude was 30. The sampling sequence consisted of 140 data days separated by 4-day-longgaps (duty cycle 0.2). Data were sampled hourly; total numberof hour markers in the array was 2 16). The frequencies were extracted within the resolution of 122=216and 242=216for the semidiurnal and diurnal bands, respectively. 17

--- Page 6 ---
–100DATA AMPLITUDE 10 510 4100EXTRACTED FOURIER5000 10 4 5 x 10 + 2 x 10 4 5 x 10 4 3 x 10 4TIME, hr 5000 10 4 5 x 10 4 2 x 10 4 5 x 10 4 3 x 10 4FREQUENCY, 1/2 15 hr0 5000 10 4 5 x 10 4 2 x 10 4 5 x 10 4 3 x 10 4FREQUENCY, 1/2 15 hr05000 10 4 5 x 10 4 2 x 10 4 5 x 10 4 3 x 10 4FREQUENCY, 1/2 15 hr0Fig. 1. Results of simulation experiments: (a) the original data, (b) the original Fourier map, (c) the clean Fourier map, (d) the residual Fourier map for simulated data with four diurnal and four semidiurnal signals (parameters of Table 2) buried in the background of Gaussian noise. The noise level was 30, the duty cycle was 0.2, the number of data days was 270 (data sampled hourly). The signals were extracted in eight iteration steps. 10 41000FOURIER ORIGINAL 10 41000FOURIER RESIDUAL 100(a) (c)(b) (d)0100 10 5100 18

--- Page 7 ---
□□ □□□ □ Table 3. Extraction results for the same eight oscillatory components as in Table 2 for periodically repeating observationalsessions. Ndata daysNoise Duty level cycle 740 140 70 01 8 s,2c 8s,2c 8s,2i 2 8 s,2c 8s,2c 8s,2c 1 8 s,2c 8s,2c 7s,3c 10 1 8 s,2c 8s,2c 8s,2i 2 8 s,2c 8s,2c 8s,1c,1i 1 1i,3s,5i,1s 8s,2c 8s,2i [5s,2c,3s)[ 8s,2c][ 8s,1c,1i] 30 1 8 s,2c 8s,2n 6s,4n 2 8 s,2c 7s,1i,2n 6s,1i,3n [8s,2c][ 8 s,2n][ 7s,3n] 1 1i,3s,5i,1s 6s,2i,2n 5s,1i,4n [3s,1c,5s,1c][ 8s,2n][ 6s,1i,3n] 100 1 6 s,2i,2n 4s,6n 3s,7n 2 5s,1c,3i,1n 4s,1n,5i 3s,7n [6s,2n,2i][ 4s,1i,5n][ 3s,7n] 1 3 s,1n,6i 3s,2n,5i 2s,3i,5n [5s,2c,3n][ 3s,7n][ 4s,2i,4n] (sidelobes produced by one frequency contribute spurious strength at other frequencies). Therefore, the use of the full DS(§l) may add (or subtract) signal strength at the lth or other frequency. The appearance ofc’s (cstands for correction) in Table 3 signiﬂes that some of the excess strength has been recovered on subsequent iteration of the algorithm (other side eﬁects may be errors at other frequencies or noise). Thenumber of successful extractions decreases with decreasing T, decreasing duty cycle, and increasing noise. In Table 3, successful extractions range from all eight (low noise, long Tcase) to two components (70 data days, a 0.1 duty cycle, noise amplitude of 100, corresponding to the minimum extracted amplitude{noiseratio of 0.2). For 140 and 740 data days, the critical amplitude{noise ratio is 0.1 and 0.07, respectively,when the duty cycle is 0.2; the ratio is somewhat less (higher) for higher (lower) duty cycles. Note thatin case of zero noise, the extraction was complete in most cases. Because of high sidelobes, the most unfavorable situation for extraction is a periodic sampling sequence. In Table 3, results are also listed (in square brackets) for nonperiodic sequences characterized by thenonperiodicity parameter ¾ pof about 1 (corresponding to randomly distributed observation sessions). Here,¾pis the normalized root-mean-square deviation of the separation pibetween the beginning times for subsequent sessions, ¾p·vuut1 NdNdX iµpi <p>¡1¶2 (6) where<p> is the average separation, <p> =PNd ipi=Nd, whereNdis the total number of (1-day-long) observation sessions. The main eﬁect of a ﬂnite (nonzero) ¾pis to somewhat suppress the height of the spectral peaks at the signal and gap intermodulation frequencies. The suppression is most eﬁective for 19

--- Page 8 ---
□□ □ long sampling sequences, because (for periodically repeating sessions) the sidelobes are biggest there. For example, for 740 data days, a 10-percent duty cycle, and a noise level of 100, the randomization increased(Table 3) the number of extracted frequencies from 3 to 5. The randomization makes the extraction easierto obtain if the sampling sequence is long and random. In the majority of the simulations, the optimal frequency index was found to coincide with the frequency of the highest spectral peak in the current Fourier map. Occasionally, however, the second or third (ortenth) strongest peak actually produced the smallest quadratic residual function M l, suggesting that during the search for the optimal frequency, one should test some ﬂnite number ( Np) of the biggest spectral peaks. For the sequences tested, we have found that Np•50 was quite su–cient. The fact that only a relatively small number of candidate l’s need to be inspected makes the minimization of the Ml rather e–cient. For Npinspected peaks, the CPU time scales as Nc£Np£N£logN, whereNcis the number of iterations (typically not higher than several tens), and where N£logNis the scale factor for CPU time for FFT of data arrays of dimension N. (If all indices lwere to be tested, the CPU time would scale asNcN2logN, which for large arrays would be excessive.) For Nc=8 ,Np= 10, andN=1 018, the CPU time was about 1 minute on a VAX 3000/400 and several minutes on a VAX 4000/90. B. Noninteger Frequency Index The precision of the extracted frequencies aﬁects the accuracy of the extracted phase and, ultimately, the success of retrieving oscillatory components with lower amplitudes. To improve the extraction accu-racy, the total length of the sampling sequence Tcan be increased (by padding it with zeroes) to a higher power of two. Or, if the array size is limited, a second version of the algorithm can be used that involvesnonintegral l’s. This noninteger version is especially useful if, in addition to high frequencies, the data contain slowly varying signals (for ¿on the order of or longer than T, the resolution ¿ 2=Tresulting from the use of the standard discrete FFT would be on the order of or greater than ¿itself). The use of the noninteger algorithm allows for elimination of strong low-frequency components before the extraction ofhigh-frequency components. If the data include frequencies not equal to an integer multiple of 1 =N, the residual is minimum for a set§(l+¢l), where 0•¢l•1. The noninteger algorithm searches for the optimal ¢ lby using a noninteger FFT together with a minimization scheme that does not require construction of derivatives.The main mathematical basis for the algorithm is described in the Appendix. The noninteger algorithmwas tested by using the same simulated data as for the integer algorithm. The results were similar in thatwhen one algorithm met with success, so did the other algorithm. The trade-oﬁ was a bigger array sizefor the integer algorithm versus longer CPU time for the noninteger algorithm. To achieve a fractionalaccuracy of –¿=¿ for an oscillatory signal with the period ¿, the array size (i.e., the total length of the sampling sequence T) used by the integer algorithm must be greater than ¿(¿=–¿ ). For the noninteger algorithm, the required array size is less; however, the CPU time is increased due to the use of thesearch and minimization procedure that optimizes ¢ l. For the eight oscillatory components in Table 2, CPU time for the noninteger algorithm was typically a factor of 10 bigger, while the frequency accuracyincreased by one signiﬂcant place for the same array size in both algorithms. The principal application of the noninteger algorithm is for spectral analysis of data with both rapid and slow modulations present. To simulate a train of hourly residuals of Earth orientation parametersobtained from reduced VLBI data, the simulated data consisted of the same four near-diurnal and fournear-semidiurnal oscillatory frequencies as in Table 2, superimposed on a slowly varying signal that wasrepresented by a sum of 1-month, 1-year, and 18-year periodic components. The signal was imbeddedin a background of Gaussian noise on the same order of magnitude as the strongest diurnal component.The extraction success depends on the length and structure of the sampling sequence, noise level, andthe number and amplitudes of low-frequency components. A typical sampling sequence consisted of 270data days (data sampled hourly) separated by 4-day-long gaps (with a corresponding duty cycle of 0.2and a total sampling sequence length of T= 3.5 yr). Table 4 summarizes the simulation parameters for 20

--- Page 9 ---
□□ three cases: In the ﬂrst case, the amplitudes of the 1-month, 1-year, and 18-year components were 500, 2000, and 0, respectively; in the second case, the amplitudes were 500, 2000, and 200,000, respectively;in the third case, the amplitudes were 500, 20,000, and 500,000, respectively. The noise level was 30, andthe eight diurnal and semidiurnal signals were the same as in Table 2 (amplitudes between 3.2 and 23).Figures 2, 3, and 4 show the corresponding original data and the original, residual, and clean Fouriermaps. On comparison, the ﬂgures illustrate the eﬁect of the number and amplitudes of low-frequencycomponents on the success of extraction of high-frequency components. Table 4. Extraction results when the data also contained strong low-frequency components (corresponding to Figs. 1, 2, 3,and 4).a Relative ampitudes of Iterations for extraction of low-frequency components high-frequency components (18 yr): 0 ( 1y r ) : 0 1 ,2 ,3 ,4 ,5 ,6 ,7 ,8 (1 mo): 0 (18 yr): 0 (1 yr): 2,000 4, 5, 6, 7, 8, 9, 10, 11 (1 mo): 500 (18 yr): 200,000 (1 yr): 2,000 11, 14, 15, 18, 20, 22, 25, 31 (1 mo): 500 (18 yr): 500,000 (1 yr): 20,000 26, 28, 31, 47, 53, 65, 72, 86 (1 mo): 500 aThe listed numbers designate iterations that extracted one of the high-frequency components. The high-frequency componentsare the same as in Table 2, the number of data days was 270(data sampled hourly), the duty cycle was 0.2, and the noiselevel was 30. In Figs. 2{4, iterative application of the algorithm has resulted in successful extractions of the diurnal and semidiurnal frequencies in all cases; however, the extraction process was lengthier (resulting in richerrecovered spectral content) when the number and amplitudes of the original low-frequency componentswere higher. In general, the algorithm ﬂnds the strongest (in these cases, the low-frequency) componentsﬂrst. However, since the values of the extracted frequencies and phase are always somewhat in error (theaccuracy will eventually be limited by the available numerical accuracy), the eﬁect of errors in the valuesof the extracted parameters is made up by retrieving, in successive iterations, additional (false) frequen-cies, until the slow variations are matched su–ciently well for the high-frequency modulations to becomethe strongest Fourier components in the current residual map. This process of matching the time sequencewith a richer Fourier spectrum becomes more intricate with increasing amplitudes and complexity of theoriginal spectrum. In Fig. 2, the original spectrum contains no 18-year component. The high-frequencysignals were found immediately after the low (1-year and 1-month) frequency signals, except that (dueto a ﬂnite length Tof the data array) the algorithm also found (as it usually does when variations on a scale comparable to or longer that Tare present) a frequency ’1=T. In Figs. 3 and 4, the original spectrum includes an 18-year-long component with the amplitude four orders of magnitude higher than 21

--- Page 10 ---
20001000 0–1000–2000DATA AMPLITUDE 10 610 510 41000100EXTRACTED FOURIER5000 10 4 5 x 10 4 2 x 10 4 5 x 10 4 3 x 10 4TIME, hr 5000 10 4 5 x 10 4 2 x 10 4 5 x 10 4 3 x 10 4FREQUENCY, 1/2 15 hr0 5000 10 4 5 x 10 4 2 x 10 4 5 x 10 4 3 x 10 4FREQUENCY, 1/2 15 hr05000 10 4 5 x 10 4 2 x 10 4 5 x 10 4 3 x 10 4FREQUENCY, 1/2 15 hr0Fig. 2. Results for the same simulated data as in Fig. 1, but with the diurnal and semidiurnal components (Table 2) superimposed on a slowly varying signal with the amplitudes of 500 and 2000 for 1-mo and 1-yr periodic components respectively: (a) the original data, (b) the original Fourier map, (c) the clean Fourier map, (d) the residual Fourier maps. 10 710 610 510 41000FOURIER ORIGINAL 100 10 41000FOURIER RESIDUAL 100(a) (c)(b) (d) 22

--- Page 11 ---
10 610 510 410 7 5 x 10 5DATA AMPLITUDE 10 41000EXTRACTED FOURIER5000 10 4 5 x 10 4 2 x 10 4 5 x 10 4 3 x 10 4TIME, hr 5000 10 4 5 x 10 4 2 x 10 4 5 x 10 4 3 x 10 4FREQUENCY, 1/2 15 hr0 5000 10 4 5 x 10 4 2 x 10 4 5 x 10 4 3 x 10 4FREQUENCY, 1/2 15 hr05000 10 4 5 x 10 4 2 x 10 4 5 x 10 4 3 x 10 4FREQUENCY, 1/2 15 hr0Fig. 3. Results for the same simulated data as in Figs. 1 and 2, but with the diurnal and semidiurnal components (Table 2) superimposed on a slowly varying signal with the amplitudes of 500, 2000, and 200,000 for a 1-mo, 1-yr, and 18-yr periodic components respectively: (a) the original data, (b) the original Fourier map, (c) the clean Fourier map, and (d) the residual Fourier map. 10 910 8FOURIER ORIGINAL 10 41000FOURIER RESIDUAL 100(a) (c)(b) (d)10 5 x 10 52 x 10 5 10 510 610 710 810 910 101000 23

--- Page 12 ---
5 x 10 5DATA AMPLITUDE 1000EXTRACTED FOURIER5000 10 4 5 x 10 4 2 x 10 4 5 x 10 4 3 x 10 4TIME, hr 5000 10 4 5 x 10 4 2 x 10 4 5 x 10 4 3 x 10 4FREQUENCY, 1/2 15 hr0 5000 10 4 5 x 10 4 2 x 10 4 5 x 10 4 3 x 10 4FREQUENCY, 1/2 15 hr05000 10 4 5 x 10 4 2 x 10 4 5 x 10 4 3 x 10 4FREQUENCY, 1/2 15 hr0Fig. 4. Results for the same data as in Figs. 1, 2, and 3, but with the diurnal and semidiurnal components (Table 2) superimposed on a slowly varying signal with amplitudes of 500, 20,000, and 500,000 for 1-mo, 1-yr, and 18-yr periodic components, respectively: (a) the original data, (b) the original Fourier map, (c) the clean Fourier map, and (d) the residual Fourier map. 10 10FOURIER ORIGINAL 10 41000FOURIER RESIDUAL 100(a) (c)(b) (d)4 x 10 53 x 10 52 x 10 510 510 910 810 710 610 5100010 4 10 410 510 610 710 810 910 1010 11 24

--- Page 13 ---
□ the strongest diurnal component. The algorithm also ﬂts the slow variations ﬂrst. However, because the variations are not ﬂt exactly (the 18-year period was found with 2- and 3-percent accuracy in Figs. 3and 4, respectively, and the 1-year and 1-month periods were found with 0.7- and 0.1-percent accuracy,respectively), the algorithm continues to search for additional frequencies until the ﬂt is su–ciently tight.In Figs. 3 and 4, the high frequencies were extracted at the 11th, 14th, 15th, 18th, 20th, 22nd, 25th,and 31st iterations, and at the 26th, 28th, 31st, 47th, 53rd, 65th, 72nd, and 86th iterations, respectively.Thus, the complexity of the low-frequency content will play a signiﬂcant role in establishing limits on thealgorithm applicability. IV. Summary and Conclusions A new algorithm has been developed for spectral analysis of sparse, irregularly sampled data with low signal-to-noise ratios; the extracted parameters include frequency, phase, and amplitude of the signalcomponents. The algorithm identiﬂes the strongest component as that component which when passedthrough the same sampling sequence as the original data produces a Fourier image that is best matchedto the current residual map. The algorithm has met with success in trials with simulated data, includingthose of a type similar to hourly residuals for Earth orientation parameters. The simulated data consistedof four near-diurnal and four semidiurnal oscillatory components with amplitudes varying by an order ofmagnitude. The background noise was on the same order of magnitude as the strongest high-frequencycomponent. The number of data days ranged from 70 to 740 (data sampled hourly), and the duty cyclefor the observation sessions varied between 1 and 0.1. Two versions of the algorithm were developed. Inthe integer version, the frequency solution is limited to 1 =T, whereTis the sampling sequence length. With only the high-frequency components present in the data, the integer version was successful inextracting all components with an amplitude{noise ratio greater than about 0.2; the extraction successwas higher (less) for longer (shorter) data sequences and higher (lower) duty cycles. Sessions that arenot periodic make the extraction easier to achieve since the sidelobes (produced by the interference withthe average periodicity of the sessions) are less than for the periodic case. Sidelobes associated withone frequency can contribute signal at other frequencies. If the residual map has been constructed bycompletely subtracting the identiﬂed spectral peak, the subtracted sidelobes can produce errors in thisand other estimates. The solution to this problem is to subtract the peak in fractions. That is, at multipleapplications of the algorithm, one subtracts from the current residual map only a fraction of the imagethat has been constructed by using the peak full strength. The eﬁect of subtracted fractions on theextraction results could be used to achieve conﬂdence in the found solutions. Another test of conﬂdencecan be obtained by modifying the observation strategy, e.g., by changing the duty cycle, the length ofthe sampling sequence, and the gap randomness. The frequency resolution can be increased by paddingthe data array with zeroes to a higher power of two (higher T). For signal frequencies that are not integer multiples of the minimum discrete FFT frequency, the residual map will be minimized by a noninteger frequency value. We have implemented (and tested)an algorithm version that searches for a noninteger frequency index. The resolution is greatly improvedover 1=Twithout requiring an increase in the array length. However, the CPU time is increased. In simulations with diurnal and semidiurnal bands, the typical CPU time was longer by a factor of 10,while the extracted frequency accuracy increased by one signiﬂcant place relative to results obtainedwith the integer algorithm. Many real data also contain (in addition to the high frequencies) verystrong low-frequency components. Unless some other scheme is used to eliminate the slow variationsﬂrst, when applied, the algorithm ﬂts the slowly varying signal with low frequencies before it searchesfor the high frequencies. The increase in the extraction accuracy comes at the expense of increasedCPU time. The CPU time is increased depending on the signal frequencies, strength, and number oflow-frequency components. Several types of simulated data with strong 18-year, 1-year, and 1-monthperiodic components were analyzed in detail in Section III.B (Figs. 2, 3, and 4). The accuracy of theextracted frequencies in°uences the e–ciency of retrieval of components with lower amplitudes. 25

--- Page 14 ---
□□ □ For uniformly spaced time markers, the CPU time scales as a constant £Nc£Np£N£logN, where Ncis a number of iterations of the algorithm (to ﬂnd multiple oscillatory components), Npi san u m b e r of candidate spectral peaks that must be inspected to minimize the residual sum, and Nis the array total size chosen as a power of 2. For 218time markers in the sampling sequence and eight cleaning steps, typical CPU time for the integer algorithm was on the order of several minutes on a VAX-class machine.For the noninteger algorithm, the CPU time can exceed several hours, depending on the complexity ofthe overall frequency content. The algorithm is currently applied to actual hourly Earth orientation parameters for the available International Radio Interferometric Surveying (IRIS), Crustal Dynamics Project (CDP), and DSN VLBIdata. Acknowledgments The author is grateful to O. Sovers and C. Jacobs for encouragement and to R. Gross for critical reading of the manuscript. References [1] W. H. Press, S. A. Teukolsky, W. T. Vetterling, and B. P. Flannery, Numerical Recipes in Fortran , 2nd ed., Cambridge: Cambridge University Press, Ch. 13, pp. 530{602, 1992, and references therein. [2] M. Lazrek and F. Hill, \Temporal Window Eﬁects and Their Deconvolution From Solar Oscillation Spectra," Astron. Astrophys. , vol. 280, pp. 704{714, 1993. [3] J. A. Hogbom, \Aperture Synthesis With a Non-Regular Distribution of Inter- ferometer Baselines," Astron. and Astrophys. Supplement , vol. 15, pp. 417{426, 26

--- Page 15 ---
□□ □□□□ □ Appendix Spectral Analysis for a Noninteger Frequency Index The method outlined in Section II is frequently su–cient provided that the periodic components are su–ciently few in number, well separated in frequency, not too disparate in the relative magnitude oftheir amplitudes, and not too corrupted by the presence of noise. If stressing conditions are present, themethod can be enhanced by introducing fractional frequencies. The Fourier map becomes a function ofthe fractional value ¢ l. An additional search is performed on ¢ lto identify the residual minimum by using some standard function minimum-ﬂnding algorithm. Similarly to Eq. (1) of the main text, deﬂne the minimal function M l+¢l·NX kjDS(k)¡X §a§(l+¢l)fS §(l+¢l)(k)j2 (A-1) where all terms have the same meaning as in Eq. (1) except that the second term on the right-hand side of Eq. (A-1) represents a signal at the candidate frequency !l+¢l=2…(l+¢l)=(N–t), andfS l+¢l(k) is the Fourier transform of fl+¢l(tn)S(tn), where the periodic function fl+¢l(tn)·exp(¡2…i(n(l+ ¢l)=N))S(tn). As in the main text, the optimal value of l+¢lis found as that frequency which when ﬂltered through the same sampling sequence S(tn) as the original data provides the best match to the original Fourier map. The algorithm computes the Fourier map, DS(k), selects a value of ¢ l,0•¢l•1, and, for the selected ¢l, computes the functions fS l+¢l(k). To evaluate Ml+¢l, the values of the amplitudes al+¢lare determined from the following least-square minimization principle: @Ml @a⁄m=NX k" DS(k)¡X §a§(l+¢l)fS §(l+¢l)(k)# fS m⁄(k) = 0 (A-2) Form=§(l+¢l), Eq. (A-2) deﬂnes a linear system of two equations from which the optimal magnitudes of the unknown a§(l+¢l)’s are determined. By using these optimal a§(l+¢l)’s in Eq. (A-1), the algorithm searches for an optimal lthat minimizes Ml. (Similar to that in the main text, this minimization is most e–ciently achieved by inspecting several of the highest peaks in the original Fourier map.) Theabove-described procedure yields an optimal lfor any given ¢ l. The algorithm performs a systematic search for a ¢ lthat minimizes M l+¢las a function of ¢ lby using Brent’s method (it does not require construction of derivatives; see [1]). To compute the various functions required in the evaluation of Eqs. (A-1) and (A-2), the following relationships are used to minimize the number of the computations. Let Fdenote the discrete Fourier transform operator. Then the Fourier transform of fl+¢l(tn)S(tn)i s fS l+¢l(k)·Fkh e¡2…in(l+¢l) NS(tn)i =NX ne2…in(k¡l) Nh S(tn)e¡2…in¢l Ni =Fk¡lh S(tn)e¡2…in¢l Ni ·S(k¡l¡¢l) (A-3) 27

--- Page 16 ---
□□ □□□□ □ That is to say, the kth Fourier component of fl+¢l(tn)S(tn)i st h e(k¡l)th Fourier component of S(tn)e x p¡2…i(n¢l=N). By using relationships similar to those used to derive Eq. (A-3), Eq. (A-2) is simpliﬂed: NX kfS l+¢l(k)fS m⁄(k)=NX k;n;n0S(tn)e2…in(k¡l) NS(t0 n)e¡2…in0(k¡m) Ne¡2…in¢l N =NX n;n0–n;n0S2(tn)e¡2…in¢l N=NS(m¡l¡¢l) (A-4) and, similarly, NX kDS(k)fS m⁄(k)=NDS(m) (A-5) By using Eqs. (A-4) and (A-5), Eq. (A-2) simpliﬂes to X §S(m¤(l+¢l))a§(l+¢l)=DS(m) (A-6) Form=§(l+¢l), Eq. (A-6) is solved for a pair of coe–cients a§(l+¢l). Note that for ¢ l= 0, Eq. (A-6) reduces to Eqs. (4a) and (4b) of the main text. Other useful relationships involve the evaluation of the noninteger Fourier components of the sampling functionS(tn): S(k+¢l)=Fkh S(tn)e2…in¢l Ni (A-7) S(2(l+¢l)) =F2lh S(tn)e4…in¢l Ni (A-8) DS(l+¢l)=Flh F¡1 n[DS(k)]e¡2…in¢l Ni (A-9) The use of Eqs. (A-3){(A-5) and (A-7){(A-9) minimizes the number of computations required to recompute Eqs. (A-1) and (A-6) at each iteration step to minimize Ml. 28